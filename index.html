<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insight | An√°lise Comportamental</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6C5CE7;
            --secondary: #A29BFE;
            --background: #0F0F12;
            --card-bg: rgba(255, 255, 255, 0.05);
            --text-main: #FFFFFF;
            --text-muted: #B2BEC3;
            --accent: #FDCB6E; /* Amarelo Pato */
            --banana: #FFEAA7;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(108, 92, 231, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(253, 203, 110, 0.05) 0%, transparent 20%);
        }

        /* --- UI Elements --- */
        .container {
            text-align: center;
            z-index: 10;
            position: relative;
            width: 100%;
            max-width: 600px;
            padding: 20px;
        }

        h1 {
            font-weight: 800;
            font-size: 3rem;
            letter-spacing: -1px;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #fff 0%, #a29bfe 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeUp 0.8s ease forwards;
        }

        p.subtitle {
            color: var(--text-muted);
            font-size: 1.1rem;
            margin-bottom: 2rem;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeUp 0.8s ease 0.2s forwards;
        }

        /* Input Styles */
        .name-input {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 15px 25px;
            font-family: 'Inter', sans-serif;
            font-size: 1.1rem;
            color: white;
            width: 100%;
            max-width: 320px;
            margin-bottom: 25px;
            outline: none;
            transition: all 0.3s ease;
            text-align: center;
            opacity: 0;
            animation: fadeUp 0.8s ease 0.3s forwards;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .name-input:focus {
            border-color: var(--primary);
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 15px rgba(108, 92, 231, 0.3);
        }

        .name-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        .btn-main {
            background: var(--primary);
            color: white;
            border: none;
            padding: 16px 40px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 20px -5px rgba(108, 92, 231, 0.4);
            opacity: 0;
            animation: fadeUp 0.8s ease 0.4s forwards;
            position: relative;
            overflow: hidden;
        }

        .btn-main:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 15px 30px -5px rgba(108, 92, 231, 0.5);
        }

        .btn-main:active {
            transform: translateY(1px);
        }

        /* Bot√£o de Tentar Novamente */
        .btn-retry {
            background: transparent;
            border: 1px solid rgba(108, 92, 231, 0.3);
            color: var(--secondary);
            padding: 10px 20px;
            font-size: 0.85rem;
            font-weight: 600;
            border-radius: 20px;
            margin-top: 15px;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
        }

        .btn-retry:hover {
            background: rgba(108, 92, 231, 0.1);
            color: white;
            border-color: var(--primary);
        }

        /* --- Loader UI --- */
        .loader-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .progress-bar {
            width: 200px;
            height: 4px;
            background: rgba(255,255,255,0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 20px;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.1s linear;
        }

        .status-text {
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* --- The Reveal Stage --- */
        .reveal-stage {
            display: none; /* Ativado via JS */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            pointer-events: none; /* Para n√£o bloquear cliques se necess√°rio */
        }

        /* --- The Modern Duck (SVG Styles) --- */
        .duck-container {
            position: absolute;
            bottom: -300px; /* Come√ßa fora */
            left: 50%;
            transform: translateX(-50%);
            width: 200px;
            height: 300px;
            z-index: 20;
            filter: drop-shadow(0 20px 30px rgba(0,0,0,0.5));
            transition: bottom 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .duck-container.active {
            bottom: 20%;
        }

        /* --- ESTADOS ESPECIAIS (RAGE QUIT) --- */
        
        /* 1. Zoom na cara (Encarada) */
        .duck-container.rage-zoom {
            transform: translateX(-50%) scale(3.5) !important;
            bottom: -50px !important; /* Ajuste para focar na cara e n√£o no peito */
            z-index: 100;
            /* Sobrescreve a transi√ß√£o suave padr√£o para algo mais agressivo se quiser, 
               mas faremos isso via JS style injection para controle */
        }

        /* 2. Indo embora de lado */
        .duck-container.rage-leave {
            transform: translateX(300%) scale(3.5) !important; /* Sai da tela pela direita */
            transition: transform 0.8s ease-in !important; /* Sai r√°pido */
        }

        .duck-svg {
            width: 100%;
            height: 100%;
            overflow: visible;
        }

        .duck-body { fill: var(--accent); }
        .duck-wing { fill: #FDCB6E; filter: brightness(0.9); }
        .duck-beak { fill: #FF7675; }
        .duck-eye { fill: #2D3436; transition: fill 0.3s; }
        .duck-eye-white { fill: white; }
        .duck-leg { fill: #FF7675; }

        /* Elementos Faciais Extras (Inicialmente invis√≠veis) */
        .duck-eyebrow {
            stroke: #2D3436;
            stroke-width: 4;
            stroke-linecap: round;
            fill: none;
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            transform-origin: center;
        }

        .duck-bags { /* Olheiras */
            stroke: rgba(0,0,0,0.2);
            stroke-width: 2;
            fill: none;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .duck-vein { /* Veia na testa */
            stroke: #d63031;
            stroke-width: 3;
            fill: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .duck-sweat { /* Gota de suor */
            fill: #74b9ff;
            opacity: 0;
            transition: opacity 0.3s;
        }

        /* --- ESTADOS DE IRRITA√á√ÉO DO PATO --- */

        /* N√≠vel 1: Incomodado */
        .duck-container.stage-1 .duck-eyebrow {
            opacity: 1;
            transform: translateY(2px) rotate(10deg);
        }

        /* N√≠vel 2: Irritado/Cansado */
        .duck-container.stage-2 .duck-eyebrow {
            opacity: 1;
            transform: translateY(5px) rotate(25deg);
        }
        .duck-container.stage-2 .duck-eye {
            fill: #d63031; /* Olho vermelho */
        }
        .duck-container.stage-2 .duck-bags {
            opacity: 1;
        }

        /* N√≠vel 3: Furioso/Exausto */
        .duck-container.stage-3 .duck-eyebrow {
            opacity: 1;
            transform: translateY(6px) rotate(35deg);
        }
        .duck-container.stage-3 .duck-eye {
            fill: #b71540;
            animation: eye-twitch 0.2s infinite; /* Olho tremendo */
        }
        .duck-container.stage-3 .duck-bags {
            opacity: 1;
            stroke: rgba(0,0,0,0.4);
        }
        .duck-container.stage-3 .duck-vein {
            opacity: 1;
            animation: vein-pulse 1s infinite;
        }
        .duck-container.stage-3 .duck-sweat {
            opacity: 1;
        }

        @keyframes eye-twitch {
            0% { transform: translate(0, 0); }
            50% { transform: translate(1px, 1px); }
            100% { transform: translate(0, 0); }
        }

        @keyframes vein-pulse {
            0% { stroke-width: 2; opacity: 0.7; }
            50% { stroke-width: 4; opacity: 1; }
            100% { stroke-width: 2; opacity: 0.7; }
        }

        /* Anima√ß√£o do Pato Respirando/Flutuando */
        .duck-group {
            animation: float 3s ease-in-out infinite;
            transform-origin: bottom center;
        }

        /* --- The Card/Sign --- */
        .message-card {
            position: absolute;
            top: 0;
            right: -140px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 25px 30px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            color: #2D3436;
            width: 320px;
            opacity: 0;
            transform: scale(0.8) rotate(-10deg);
            transform-origin: bottom left;
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            transition-delay: 1.6s; /* Espera o pato subir */
            pointer-events: auto;
        }

        .message-card.show {
            opacity: 1;
            transform: scale(1) rotate(0deg);
            right: -160px;
        }

        .message-card h2 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--primary);
            margin-bottom: 5px;
        }

        .message-card .verdict {
            font-size: 1.8rem;
            font-weight: 800;
            color: #2D3436;
            line-height: 1.1;
            margin-bottom: 15px;
        }

        .name-display {
            display: block;
            font-size: 0.6em;
            color: #636e72;
            margin-bottom: 4px;
            font-weight: 600;
        }
        
        .banana-icon {
            font-size: 2rem;
            vertical-align: middle;
            animation: bounce 1s infinite;
            display: inline-block;
        }

        /* --- Particles Canvas --- */
        #confetti-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }

        /* --- Utilities --- */
        .hidden { display: none !important; }
        .fade-out { opacity: 0; pointer-events: none; transition: opacity 0.5s ease; }
        .fade-in { opacity: 1; pointer-events: auto; transition: opacity 0.5s ease; }

        @keyframes fadeUp {
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(1deg); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* Responsividade */
        @media (max-width: 600px) {
            h1 { font-size: 2rem; }
            .message-card {
                right: auto;
                left: 50%;
                top: -160px;
                transform: translateX(-50%) scale(0.8);
                width: 280px;
            }
            .message-card.show {
                transform: translateX(-50%) scale(1);
                right: auto;
            }
        }
    </style>
</head>
<body>

    <!-- Background Canvas for Particles -->
    <canvas id="confetti-canvas"></canvas>

    <div class="container">
        <!-- Tela Inicial -->
        <div id="intro-screen">
            <h1>O Algoritmo da Verdade</h1>
            <p class="subtitle">Utilizando redes neurais para analisar sua aura digital.</p>
            
            <input type="text" id="user-name" class="name-input" placeholder="Digite seu nome..." autocomplete="off">
            
            <button class="btn-main" onclick="iniciarAnalise()">Descobrir Minha Ess√™ncia</button>
        </div>

        <!-- Tela de Carregamento -->
        <div id="loading-screen" class="loader-container">
            <div class="status-text" id="status-text">Iniciando conex√£o...</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>
    </div>

    <!-- O Palco da Revela√ß√£o -->
    <div class="reveal-stage" id="reveal-stage">
        <div class="duck-container" id="duck">
            <!-- Pato Vetorial Elegante -->
            <svg class="duck-svg" viewBox="0 0 200 300" xmlns="http://www.w3.org/2000/svg">
                <g class="duck-group">
                    <!-- Pernas -->
                    <path class="duck-leg" d="M85 240 L85 270 L70 280 M115 240 L115 270 L130 280" stroke="#FF7675" stroke-width="8" stroke-linecap="round"/>
                    
                    <!-- Corpo -->
                    <ellipse class="duck-body" cx="100" cy="180" rx="70" ry="60" />
                    
                    <!-- Cabe√ßa -->
                    <circle class="duck-body" cx="100" cy="100" r="50" />
                    
                    <!-- Bico -->
                    <path class="duck-beak" d="M140 100 Q170 100 160 120 Q130 130 120 110" />
                    
                    <!-- Olho -->
                    <circle class="duck-eye" cx="115" cy="90" r="6" />
                    <circle class="duck-eye-white" cx="117" cy="88" r="2" />
                    
                    <!-- Elementos de Express√£o (Invis√≠veis por padr√£o) -->
                    <!-- Sobrancelha de Julgamento -->
                    <path class="duck-eyebrow" d="M105 82 L125 82" />
                    
                    <!-- Olheiras de Cansa√ßo -->
                    <path class="duck-bags" d="M108 96 Q115 102 122 96" />
                    
                    <!-- Veia de Estresse -->
                    <path class="duck-vein" d="M80 70 L90 75 L85 85" />
                    
                    <!-- Gota de Suor -->
                    <path class="duck-sweat" d="M65 100 Q65 95 70 100 Q75 110 65 110 Q55 110 60 100" />
                    
                    <!-- Asa -->
                    <path class="duck-wing" d="M60 170 Q100 140 130 170 Q100 210 60 170" />
                    
                    <!-- Brilho no topo da cabe√ßa -->
                    <path fill="rgba(255,255,255,0.2)" d="M80 70 Q100 60 120 70" />
                </g>
            </svg>

            <!-- A Placa Modernosa -->
            <div class="message-card" id="message-card">
                <h2>Resultado da An√°lise</h2>
                <div class="verdict">
                    <!-- Conte√∫do inserido via JS -->
                </div>
                <button class="btn-retry" onclick="reiniciar()">Isso n√£o √© verdade, fa√ßa de novo</button>
            </div>
        </div>
    </div>

    <script>
        // --- L√≥gica de Estado e Anima√ß√£o ---
        let userName = "";
        
        // Mem√≥ria do Troll
        let lastUserName = "";
        let lastResultIndex = -1;
        let retryCount = 0; // O contador de teimosia

        function iniciarAnalise() {
            const intro = document.getElementById('intro-screen');
            const loader = document.getElementById('loading-screen');
            const progress = document.getElementById('progress-fill');
            const status = document.getElementById('status-text');
            const nameInput = document.getElementById('user-name');

            // Valida√ß√£o simples
            userName = nameInput.value.trim();
            if (!userName) {
                nameInput.classList.add('shake');
                nameInput.focus();
                setTimeout(() => nameInput.classList.remove('shake'), 500);
                return;
            }

            // L√≥gica de Retries Progressiva (Escalada de Bullying)
            if (lastUserName !== "" && userName.toLowerCase() === lastUserName.toLowerCase()) {
                retryCount++;
            } else {
                // Se mudou o nome, reseta tudo
                retryCount = 0;
                lastUserName = userName; 
                lastResultIndex = -1; // Libera novo sorteio se mudar o nome
            }

            // 1. Fade out da intro
            intro.classList.add('fade-out');
            
            setTimeout(() => {
                intro.style.display = 'none';
                loader.style.display = 'flex';
                // Remove classe fade-out se tiver (do reset)
                loader.classList.remove('fade-out');
                progress.style.width = '0%';
                
                // 2. Simula√ß√£o de processamento
                simularCarregamento(progress, status, retryCount, () => {
                    // 3. Fim do carregamento, mostrar o pato
                    loader.classList.add('fade-out');
                    setTimeout(() => {
                        loader.style.display = 'none';
                        revelarPato();
                    }, 500);
                });
            }, 500);
        }

        function reiniciar() {
            // Esconde o pato e o card
            const stage = document.getElementById('reveal-stage');
            const duck = document.getElementById('duck');
            const card = document.getElementById('message-card');
            const intro = document.getElementById('intro-screen');
            
            // Remove classes especiais
            card.classList.remove('show');
            duck.classList.remove('active');
            duck.classList.remove('rage-zoom');
            duck.classList.remove('rage-leave');
            duck.style.transition = ""; // Reseta transi√ß√£o inline
            
            // Remove classes de irrita√ß√£o ao sair (ser√£o reaplicadas ao voltar se necess√°rio)
            // Mas visualmente √© melhor resetar s√≥ quando revelar de novo pra n√£o "pular"
            
            setTimeout(() => {
                stage.style.display = 'none';
                intro.style.display = 'block';
                // Pequeno delay para permitir a anima√ß√£o de fade in
                requestAnimationFrame(() => {
                    intro.classList.remove('fade-out');
                });
            }, 500);
        }

        function simularCarregamento(bar, textEl, count, callback) {
            let width = 0;
            let steps = [];

            // --- Gerador de "Trocadilhos" e Frases com o Nome (Base Expandida - 100+ varia√ß√µes) ---
            const frasesComNome = [
                `Verificando se "${userName}" rima com "problema"...`,
                `Consultando a capivara de ${userName}...`,
                `Tentando entender o que ${userName} tem na cabe√ßa...`,
                `Calculando o QI de ${userName} (buscando lupa)...`,
                `Traduzindo "${userName}" para o idioma dos patos...`,
                `Analisando a aura de ${userName}... (t√° meio cinza)`,
                `Descobrindo por que ${userName} clicou nisso...`,
                `Escaneando as redes sociais de ${userName}... (que vergonha)`,
                `Comparando ${userName} com uma batata...`,
                `Acessando o hist√≥rico de ${userName}... (meus olhos!)`,
                `Perguntando aos astros sobre ${userName}... (eles riram)`,
                `Verificando se ${userName} √© um rob√¥ (provavelmente n√£o, rob√¥s s√£o espertos)`,
                `Medindo a densidade √≥ssea da cabe√ßa de ${userName}...`,
                `Tentando encontrar um pensamento l√≥gico em ${userName}...`,
                `Analisando a coordena√ß√£o motora de ${userName}...`,
                `Contando quantas vezes ${userName} piscou (0 vezes, que medo)...`,
                `Baixando a ficha criminal de ${userName} no jardim de inf√¢ncia...`,
                `Perguntando pro ChatGPT o que h√° de errado com ${userName}...`,
                `Verificando se ${userName} sabe descascar laranja...`,
                `Analisando o gosto musical duvidoso de ${userName}...`,
                `Tentando n√£o julgar ${userName} (falhando miseravelmente)...`,
                `Procurando a gra√ßa na vida de ${userName}... (erro 404)`,
                `Calculando quanto tempo ${userName} perde na internet...`,
                `Detectando v√°cuo absoluto entre as orelhas de ${userName}...`,
                `Comparando a beleza de ${userName} com um ornitorrinco...`,
                `Verificando se ${userName} foi trocado na maternidade...`,
                `Analisando a postura de camar√£o de ${userName}...`,
                `Lendo a mente de ${userName}... (est√° em branco)`,
                `Consultando os universit√°rios sobre o caso de ${userName}...`,
                `Verificando se ${userName} acredita em Terra Plana...`,
                `Medindo o n√≠vel de teimosia de ${userName}... (infinito)`,
                `Procurando a dignidade de ${userName}... (n√£o encontrada)`,
                `Simulando como ${userName} seria se fosse inteligente...`,
                `Verificando se ${userName} coloca feij√£o por baixo do arroz...`,
                `Analisando as escolhas de vida de ${userName}... (tr√°gico)`,
                `Tentando achar um talento em ${userName}... (ainda procurando)`,
                `Calculando a chance de ${userName} trope√ßar hoje... (99%)`,
                `Verificando se ${userName} fala "iogurte" ou "io-gurt"...`,
                `Acessando mem√≥rias constrangedoras de ${userName}...`,
                `Rastreando a √∫ltima vez que ${userName} fez algo √∫til...`,
                `Comparando ${userName} com uma porta (a porta venceu)...`,
                `Verificando se ${userName} lava atr√°s da orelha...`,
                `Analisando o karma de ${userName}... (est√° negativado)`,
                `Procurando o bot√£o de "desligar" em ${userName}...`,
                `Verificando se ${userName} j√° comeu cola na escola...`,
                `Calculando o preju√≠zo que ${userName} d√° pra sociedade...`,
                `Analisando a caligrafia de m√©dico de ${userName}...`,
                `Verificando se ${userName} √© parente do Patolino...`,
                `Tentando explicar f√≠sica qu√¢ntica para ${userName}... (desisti)`,
                `Verificando se ${userName} sabe fritar ovo sem queimar...`
            ];

            // Pega 2 frases aleat√≥rias diferentes
            const f1 = frasesComNome[Math.floor(Math.random() * frasesComNome.length)];
            let f2 = frasesComNome[Math.floor(Math.random() * frasesComNome.length)];
            while (f1 === f2) {
                f2 = frasesComNome[Math.floor(Math.random() * frasesComNome.length)];
            }

            if (count === 0) {
                // NORMAL
                steps = [
                    { w: 15, t: `Iniciando dossi√™ sobre ${userName}...` },
                    { w: 40, t: f1 },
                    { w: 65, t: "Detectando n√≠veis cr√≠ticos de lerdeza..." },
                    { w: 85, t: f2 },
                    { w: 100, t: "Veredito pronto. Se prepare." }
                ];
            } else if (count === 1) {
                // TROLL LEVE
                steps = [
                    { w: 10, t: `L√° vem o(a) ${userName} de novo...` },
                    { w: 30, t: `Tentando mudar o destino de ${userName}...` },
                    { w: 60, t: "Subornando o algoritmo (falha)..." },
                    { w: 85, t: "Reutilizando an√°lise anterior..." },
                    { w: 100, t: "Nada mudou, sinto muito." }
                ];
            } else if (count === 2) {
                // TROLL M√âDIO
                steps = [
                    { w: 10, t: "S√©rio? De novo?" },
                    { w: 40, t: `O nome ${userName} significa "Teimosia" em grego?` },
                    { w: 70, t: "Reciclando pixels..." },
                    { w: 90, t: "Gastando energia √† toa..." },
                    { w: 100, t: "L√° vai..." }
                ];
            } else {
                // TROLL PESADO
                steps = [
                    { w: 10, t: "PELO AMOR DE DEUS..." },
                    { w: 40, t: `${userName.toUpperCase()}, PARE AGORA!` },
                    { w: 60, t: "Vou chamar a pol√≠cia da internet..." },
                    { w: 80, t: "Gerando insulto aleat√≥rio..." },
                    { w: 100, t: "TOMA!" }
                ];
            }

            let stepIndex = 0;

            const interval = setInterval(() => {
                if (width >= 100) {
                    clearInterval(interval);
                    setTimeout(callback, 500);
                } else {
                    if (stepIndex < steps.length && width >= steps[stepIndex].w) {
                        textEl.innerText = steps[stepIndex].t;
                        stepIndex++;
                    }
                    width += Math.random() * 1.5; 
                    if(width > 100) width = 100;
                    bar.style.width = width + '%';
                }
            }, 60);
        }

        function revelarPato() {
            const stage = document.getElementById('reveal-stage');
            const duckContainer = document.getElementById('duck');
            const card = document.getElementById('message-card');
            
            // --- ATUALIZA√á√ÉO DO PATO: SISTEMA DE EXPRESS√ïES ---
            // Remove classes antigas
            duckContainer.classList.remove('stage-1', 'stage-2', 'stage-3');
            
            // Adiciona classe baseada na insist√™ncia
            if (retryCount >= 3) {
                duckContainer.classList.add('stage-3');
            } else if (retryCount === 2) {
                duckContainer.classList.add('stage-2');
            } else if (retryCount === 1) {
                duckContainer.classList.add('stage-1');
            }
            
            // Formatar nome e adicionar apelidos se for teimoso
            let displayName = userName.charAt(0).toUpperCase() + userName.slice(1);
            
            // Apelidos carinhosos para insistentes
            if (retryCount >= 2) {
                const adjetivos = ["(o Teimoso)", "(o Insistente)", "(o Chato)", "(o Inconformado)", "(o Sem No√ß√£o)", "(o Mala)", "(o Chiclete)"];
                const indiceAdj = Math.min(retryCount - 2, adjetivos.length - 1);
                displayName += " " + adjetivos[indiceAdj];
            }

            const prefix = `<span class="name-display">${displayName}, a verdade √© que:</span>`;

            // --- BANCO DE DADOS GIGANTESCO (VERS√ÉO 4.0 - SEM REPETI√á√ïES) ---
            
            const bananaReasons = [
                "Voc√™ tem a coluna vertebral de uma gelatina de pot√°ssio.",
                "Se a vida te d√° lim√µes, voc√™ troca por bananas porque √© mais f√°cil mastigar.",
                "Sua atitude √© t√£o firme quanto uma casca pisada no asfalto quente.",
                "Voc√™ n√£o toma decis√µes, voc√™ apenas amadurece e espera algu√©m te comer.",
                "Sua √°rvore geneal√≥gica √© uma bananeira: muita sombra e nenhuma a√ß√£o.",
                "Voc√™ √© rico em vitaminas, mas pobre em coragem.",
                "Todo mundo te descasca com uma facilidade humilhante.",
                "Voc√™ come√ßa verde de inveja e termina preto de tanto apanhar da vida.",
                "Sua rigidez moral dura menos que banana fora da geladeira.",
                "Voc√™ √© o ingrediente principal da vitamina da covardia.",
                "Seu habitat natural √© a fruteira da in√©rcia.",
                "Voc√™ √© inofensivo, curvo e f√°cil de manipular.",
                "Pot√°ssio alto, dignidade no ch√£o.",
                "Voc√™ escorrega nas pr√≥prias decis√µes erradas.",
                "At√© os macacos do zool√≥gico te acham f√°cil demais.",
                "Voc√™ foi feito para ser amassado com aveia e mel.",
                "Sua casca protege um interior mole e sem fibra.",
                "Voc√™ vive em cacho porque morre de medo de ficar sozinho.",
                "Sua biografia poderia ser escrita numa casca jogada no lixo.",
                "Voc√™ √© t√£o amea√ßador quanto uma arma de brinquedo amarela.",
                "Seu superpoder √© atrair moscas de fruta (problemas pequenos).",
                "Voc√™ √© doce, mas enjoa r√°pido.",
                "Sua consist√™ncia emocional √© de mingau.",
                "Voc√™ √© a fruta oficial da procrastina√ß√£o.",
                "Seu destino √© virar doce, porque como fruta in natura j√° falhou.",
                "Voc√™ n√£o enfrenta o problema, voc√™ cria pintinhas marrons e desiste.",
                "Voc√™ amadurece e apodrece no mesmo dia.",
                "Sua firmeza √© lend√°ria... por durar 5 minutos.",
                "Voc√™ √© o tipo que cai na pr√≥pria casca.",
                "Sua casca √© amarela para combinar com seu medo.",
                "Voc√™ √© mole demais para este mundo crocante.",
                "Sua vida √© um eterno 'vou ver e te aviso'.",
                "Voc√™ dobra com o vento, literalmente.",
                "Seu esp√≠rito animal √© uma salada de frutas passadas.",
                "Voc√™ √© a sobremesa que ningu√©m pediu.",
                "Sua casca brilha, mas por dentro √© s√≥ decep√ß√£o.",
                "Voc√™ √© mais mole que sopa de minhoca.",
                "Voc√™ tem medo de escuro e de faca de manteiga.",
                "Sua aud√°cia √© zero, seu pot√°ssio √© dez.",
                "Voc√™ √© o rei do 'tanto faz'.",
                "Sua iniciativa √© compar√°vel a uma planta de pl√°stico.",
                "Voc√™ espera a vida te descascar.",
                "Voc√™ √© a prova de que nem tudo que √© ouro brilha (√†s vezes √© s√≥ banana).",
                "Voc√™ √© macio demais para a selva de pedra.",
                "Voc√™ n√£o tem fibra, tem polpa.",
                "Sua resist√™ncia √† press√£o √© nula.",
                "Voc√™ √© o acompanhamento, nunca o prato principal.",
                "Voc√™ √© a fruta mais humilde (leia-se: sem autoestima).",
                "Voc√™ se machuca at√© no transporte.",
                "Sua validade expira assim que o problema chega.",
                "Voc√™ √© a defini√ß√£o bot√¢nica de 'tanto faz'."
            ];

            const bobaoReasons = [
                "Sua aura digital tem o formato exato de um nariz de palha√ßo.",
                "O algoritmo tentou ler sua mente e encontrou um macaco batendo pratos.",
                "Seu QI briga diariamente para empatar com a temperatura ambiente.",
                "Voc√™ ri de piadas que ningu√©m contou (e ri errado).",
                "Sua bio do Tinder deveria ser 'buscando c√©rebro compat√≠vel'.",
                "Foi detectado um v√°cuo absoluto onde deveria haver esperteza.",
                "Voc√™ √© o tipo de pessoa que empurra portas onde est√° escrito 'PUXE'.",
                "Seu anjo da guarda bebe em servi√ßo pra aguentar.",
                "Voc√™ √© a raz√£o pela qual shampoo tem instru√ß√µes de uso.",
                "Sua sagacidade √© compar√°vel a uma porta entreaberta.",
                "Voc√™ confundiu detergente com azeite ontem, admita.",
                "Sua densidade intelectual flutua perigosamente no negativo.",
                "Voc√™ acha que 'nuvem' √© onde os anjos moram, n√£o onde salvam arquivos.",
                "Voc√™ perdeu o jogo da velha jogando sozinho.",
                "Sua linha de racioc√≠nio √© um c√≠rculo vicioso de bobagens.",
                "Se esperteza fosse √°gua, voc√™ seria o deserto do Atacama.",
                "Voc√™ √© simp√°tico, pena que a luz do teto n√£o acende.",
                "Tem algu√©m em casa a√≠ dentro? O eco diz que n√£o.",
                "Sua complexidade mental cabe num post-it dobrado ao meio.",
                "Voc√™ √© um bob√£o modelo de f√°brica, sem opcionais.",
                "A NASA estuda seu c√©rebro em busca do v√°cuo perfeito.",
                "Voc√™ √© a v√≠rgula errada na frase da vida.",
                "Seu racioc√≠nio √© t√£o lento que viaja no tempo para o passado.",
                "Voc√™ √© fofo, mas cognitivamente desafiado.",
                "O pato te olhou, suspirou e sentiu pena.",
                "Voc√™ tenta dar zoom em fotos impressas.",
                "Sua senha do banco deve ser 1234.",
                "Voc√™ acredita que o 'M' do McDonald's √© de 'Maria'.",
                "Voc√™ j√° tentou secar gelo no sol.",
                "Sua capacidade de foco √© menor que a de um dory.",
                "Voc√™ ri quando n√£o entende (ou seja, ri o tempo todo).",
                "Voc√™ √© o amigo que todo mundo explica a piada depois.",
                "Sua mente √© um campo vasto... e vazio.",
                "Voc√™ procura o celular usando a lanterna do celular.",
                "Voc√™ trope√ßa em superf√≠cies perfeitamente planas.",
                "Sua l√≥gica faria Arist√≥teles chorar no banho.",
                "Voc√™ √© a prova de que √© poss√≠vel viver no modo autom√°tico.",
                "Sua sabedoria cabe num biscoito da sorte vazio.",
                "Voc√™ √© o bobo da corte do seu pr√≥prio reino.",
                "Seu processador mental √© um Pentium 2.",
                "Voc√™ acha que Bluetooth √© um dente azul.",
                "Voc√™ pergunta 'que horas s√£o?' olhando pro rel√≥gio.",
                "Voc√™ √© a personifica√ß√£o do meme 'confused math lady'.",
                "Sua ast√∫cia foi esquecida no √∫tero.",
                "Voc√™ √© inocente demais para a maldade do mundo (e para a tabuada).",
                "Voc√™ assopra sorvete pra esfriar.",
                "Voc√™ √© o 'caf√© com leite' da vida adulta.",
                "Sua mente √© um livro em branco (com desenhos nas margens).",
                "Voc√™ √© feliz, e a ignor√¢ncia √© uma b√™n√ß√£o.",
                "Sua cota de genialidade acabou em 1999."
            ];

            const peixeReasons = [
                "Sua mem√≥ria RAM biol√≥gica dura exatos 3 segundos (igual a de um peixinho).",
                "Voc√™ nada, nada e morre na praia toda vez (metaforicamente e nos jogos).",
                "Voc√™ abre a geladeira e esquece o que foi buscar 5 vezes ao dia.",
                "Sua boca vive aberta esperando a ra√ß√£o cair do c√©u.",
                "Voc√™ cai em qualquer isca que a vida joga (inclusive spam de email).",
                "Sua capacidade de foco √© menor que a de um kinguio dourado.",
                "Voc√™ vive num aqu√°rio mental e acha que √© o oceano Atl√¢ntico.",
                "Seus olhos est√£o abertos, mas o sinal n√£o chega no Wi-Fi do c√©rebro.",
                "Voc√™ se assusta com o pr√≥prio reflexo no vidro do carro.",
                "Sua profundidade intelectual √© de um pires com √°gua da chuva.",
                "Voc√™ nada em c√≠rculos e acha que est√° viajando o mundo.",
                "Sua habilidade de comunica√ß√£o se resume a 'blub blub'.",
                "Voc√™ √© ornamental: bonito de ver, in√∫til na pr√°tica.",
                "Qualquer brilho te distrai por horas (olha, uma moeda!).",
                "Voc√™ morde o anzol mesmo vendo a linha e o pescador.",
                "Sua vida √© um eterno 'nadaremos, nadaremos' sem sair do lugar.",
                "Voc√™ tem a personalidade vibrante de uma alga marinha.",
                "Seu c√©rebro √© composto por 90% √°gua e 10% escamas.",
                "Voc√™ √© escorregadio quando confrontado com qualquer responsabilidade.",
                "Sua aten√ß√£o dura menos que um v√≠deo de 5 segundos do TikTok.",
                "Voc√™ esqueceu o in√≠cio desta frase antes de chegar ao ponto final.",
                "Voc√™ √© facilmente pescado por promo√ß√µes de 'ganhe um iPhone gr√°tis'.",
                "Sua express√£o facial padr√£o √© um eterno 'h√£?'.",
                "Voc√™ vive na superf√≠cie porque tem medo de pensar fundo.",
                "Voc√™ √© um peixe fora d'√°gua em qualquer situa√ß√£o social complexa.",
                "Sua mem√≥ria √© t√£o ruim que cada dia √© uma vida nova (o que √© bom, talvez).",
                "Voc√™ segue o cardume sem saber se est√£o indo pro abatedouro.",
                "Sua vontade pr√≥pria foi comida por um tubar√£o imagin√°rio.",
                "Voc√™ √© frio, √∫mido e tem o carisma de uma pescada morta.",
                "Glub glub glub (tradu√ß√£o: voc√™ n√£o est√° entendendo nada, n√©?).",
                "Voc√™ se perde dentro da pr√≥pria casa.",
                "Sua vida √© boiar e esperar a correnteza levar.",
                "Voc√™ tem o olhar de quem est√° processando o v√°cuo.",
                "Voc√™ √© a isca, nunca o pescador.",
                "Sua intui√ß√£o falha mais que previs√£o do tempo.",
                "Voc√™ tem medo de redes (sociais e de pesca).",
                "Voc√™ √© o Nemo, mas sem o pai procurando.",
                "Sua bolha de realidade √© impenetr√°vel.",
                "Voc√™ respira embaixo d'√°gua porque tem pregui√ßa de subir.",
                "Sua escama brilha, mas n√£o vale ouro.",
                "Voc√™ √© o rei dos 'aqu√°rios' (escrit√≥rios pequenos).",
                "Sua barbatana √© mole.",
                "Voc√™ foge de tubar√µes que nem existem.",
                "Sua vida amorosa √© um mar revolto.",
                "Voc√™ √© salgado demais para ser doce.",
                "Voc√™ escorrega das m√£os de quem tenta te ajudar.",
                "Sua l√≥gica √© subaqu√°tica (ningu√©m ouve).",
                "Voc√™ √© o √∫ltimo a saber das coisas no oceano.",
                "Sua b√∫ssola moral aponta pro fundo do mar.",
                "Voc√™ √© um bagre ensaboado."
            ];

            const patoReasons = [
                "Voc√™ faz tudo (anda, nada, voa), mas faz tudo terrivelmente mal feito.",
                "Seu andar desengon√ßado pela vida foi detectado pelo Google Earth.",
                "Muito barulho (quack) e zero efici√™ncia pr√°tica.",
                "Voc√™ se acha um cisne majestoso, mas o espelho discorda.",
                "Sua coordena√ß√£o motora digital √© lament√°vel (pare de teclar com as penas).",
                "Voc√™ tenta voar e cai, tenta nadar e afunda, tenta andar e trope√ßa.",
                "Sua vida √© uma s√©rie ininterrupta de 'quacks' mal sucedidos.",
                "Voc√™ tem penas, mas n√£o tem voo (metaforicamente falando).",
                "Voc√™ √© o cl√≠nico geral do fracasso: sabe errar em todas as √°reas.",
                "Sua gra√ßa ao se mover √© compar√°vel a uma geladeira caindo da escada.",
                "Voc√™ √© barulhento sem motivo e incomoda os vizinhos do lago.",
                "Voc√™ migra de problema em problema sem resolver absolutamente nenhum.",
                "Sua autoimagem √© de √°guia, sua realidade √© de borracha amarela de banheira.",
                "Voc√™ flutua na mediocridade com uma eleg√¢ncia duvidosa.",
                "Voc√™ bica a m√£o de quem tenta te dar p√£o.",
                "Sua cauda balan√ßa feliz, mas sua cabe√ßa n√£o processa a informa√ß√£o.",
                "Voc√™ √© a defini√ß√£o de 'pau pra toda obra' que quebra na primeira obra.",
                "Voc√™ √© um pato manco na maratona da exist√™ncia humana.",
                "Sua plumagem √© bonita, mas n√£o esconde a falta de talento real.",
                "Voc√™ faz muito estardalha√ßo para chocar um ovo vazio.",
                "Voc√™ acha que lidera a fila, mas est√° apenas fugindo do cozinheiro.",
                "Seu nado sincronizado com a realidade est√° totalmente dessincronizado.",
                "Voc√™ √© fofo de longe, mas ca√≥tico e sujo de perto.",
                "Sua dieta intelectual consiste em p√£o velho jogado por estranhos.",
                "Voc√™ grasna verdades que ningu√©m perguntou e ningu√©m quer ouvir.",
                "Voc√™ √© o patinho feio que cresceu e continuou... ex√≥tico.",
                "Sua estabilidade emocional √© como um barco de papel num lago agitado.",
                "Voc√™ molha os p√©s mas n√£o tem coragem de mergulhar de cabe√ßa.",
                "Voc√™ √© mestre em fazer bagun√ßa na √°gua parada da vida.",
                "Quack quack (tradu√ß√£o: aceite sua natureza med√≠ocre e seja feliz).",
                "Voc√™ tem bico grande e atitude pequena.",
                "Voc√™ anda rebolando, mas sem gingado.",
                "Sua impermeabilidade a conselhos √© not√°vel.",
                "Voc√™ voa em V, mas sempre na ponta errada.",
                "Voc√™ √© a ave mais confusa do reino animal.",
                "Sua vida √© um lago de incertezas.",
                "Voc√™ grasna para a lua achando que √© lobo.",
                "Sua pata √© larga para caber tanta desculpa.",
                "Voc√™ √© o Donald da vida real (sem a fama e o dinheiro).",
                "Voc√™ perde penas a cada susto.",
                "Sua orienta√ß√£o geogr√°fica √© baseada em migalhas.",
                "Voc√™ √© o alvo no tiro ao alvo da vida.",
                "Sua lagoa est√° secando.",
                "Voc√™ √© o rei da grasnada in√∫til.",
                "Sua majestade √© de isopor.",
                "Voc√™ √© um ganso disfar√ßado de gente.",
                "Sua eleg√¢ncia afundou junto com o Titanic.",
                "Voc√™ √© o pato da Fiesp (s√≥ ocupa espa√ßo).",
                "Sua vida √© um gibi sem gra√ßa.",
                "Voc√™ √© a prova de que a evolu√ß√£o √†s vezes tira f√©rias."
            ];

            const getReason = (list) => list[Math.floor(Math.random() * list.length)];

            const reasonStyle = "font-size: 0.45em; line-height: 1.5; margin-top: 15px; color: #636e72; font-weight: 500; font-style: italic; border-top: 1px solid rgba(0,0,0,0.1); padding-top: 10px;";

            // --- Seletor de Destino Aleat√≥rio ---
            const opcoes = [
                {
                    html: `${prefix}Voc√™ √© um<br><span style="color: #6C5CE7;">BANANA</span> <span class="banana-icon">üçå</span><div style="${reasonStyle}">Motivo: "${getReason(bananaReasons)}"</div>`
                },
                {
                    html: `${prefix}Voc√™ √© um<br><span style="color: #e17055;">BOB√ÉO</span> <span class="banana-icon">ü§™</span><div style="${reasonStyle}">Motivo: "${getReason(bobaoReasons)}"</div>`
                },
                {
                    html: `${prefix}Voc√™ √©<br><span style="color: #0984e3;">LESADO IGUAL PEIXE</span> <span class="banana-icon">üêü</span><div style="${reasonStyle}">Motivo: "${getReason(peixeReasons)}"</div>`
                },
                {
                    html: `${prefix}Voc√™ √© um<br><span style="color: #FDCB6E;">PATO</span> <span class="banana-icon">ü¶Ü</span><div style="${reasonStyle}">Motivo: "${getReason(patoReasons)}"</div>`
                }
            ];

            let indexEscolhido;

            if (retryCount > 0 && lastResultIndex !== -1) {
                // FOR√áA O MESMO RESULTADO se for retry
                indexEscolhido = lastResultIndex;
            } else {
                // SORTEIA NOVO se for nome novo
                indexEscolhido = Math.floor(Math.random() * opcoes.length);
                lastResultIndex = indexEscolhido;
            }
            
            const sorteio = opcoes[indexEscolhido];
            
            // Injeta o resultado no cart√£o
            document.querySelector('.verdict').innerHTML = sorteio.html;

            stage.style.display = 'block';
            
            // --- L√ìGICA DE EXIBI√á√ÉO ---

            if (retryCount >= 3) {
                // === MODO RAGE QUIT (4¬™ Tentativa+) ===
                
                // 1. Pato entra com cara de bravo
                setTimeout(() => {
                    duckContainer.classList.add('active'); 
                }, 100);

                // 2. Zoom na cara (Encarada agressiva)
                setTimeout(() => {
                    duckContainer.style.transition = "all 0.5s ease"; // Acelera o zoom
                    duckContainer.classList.add('rage-zoom');
                }, 1800);

                // 3. Pato vai embora (Sai de lado)
                setTimeout(() => {
                    duckContainer.classList.add('rage-leave');
                }, 4000); // Fica encarando por ~2.2s

                // 4. Mostra o cart√£o "Bilhete de despedida"
                setTimeout(() => {
                    card.classList.add('show');
                    triggerConfetti();
                }, 4500);

            } else {
                // === MODO NORMAL ===
                setTimeout(() => {
                    duckContainer.classList.add('active');
                    
                    // Disparar confetes quando o cart√£o aparecer
                    setTimeout(() => {
                        card.classList.add('show');
                        triggerConfetti();
                    }, 1600);
                }, 100);
            }
        }

        // --- Sistema de Part√≠culas (Confetti) Minimalista ---
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        class Particle {
            constructor() {
                this.x = canvas.width / 2; // Come√ßa no centro (atr√°s do pato)
                this.y = canvas.height * 0.8;
                this.vx = (Math.random() - 0.5) * 20;
                this.vy = (Math.random() - 2) * 20 - 10;
                this.gravity = 0.5;
                this.color = `hsl(${Math.random() * 360}, 100%, 60%)`;
                this.size = Math.random() * 8 + 4;
                this.rotation = Math.random() * 360;
                this.rotationSpeed = (Math.random() - 0.5) * 10;
                this.life = 1.0;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.vy += this.gravity;
                this.rotation += this.rotationSpeed;
                this.life -= 0.01;
            }

            draw() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation * Math.PI / 180);
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.life;
                ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size);
                ctx.restore();
            }
        }

        function triggerConfetti() {
            for(let i=0; i<150; i++) {
                particles.push(new Particle());
            }
            animateConfetti();
        }

        function animateConfetti() {
            if(particles.length === 0) return;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            for(let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.update();
                p.draw();
                
                if(p.life <= 0 || p.y > canvas.height) {
                    particles.splice(i, 1);
                }
            }
            
            requestAnimationFrame(animateConfetti);
        }

    </script>
</body>
</html>
